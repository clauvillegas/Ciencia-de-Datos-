<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fundamentos de Python · Portafolio</title>
  <meta name="description" content="Módulo Fundamentos de Python: índice y ejemplos con código desde .ipynb" />
  <link rel="icon" href="../assets/favicon.ico" />
  <link rel="stylesheet" href="../styles.css" />

  <!-- Prism (resaltado + líneas) -->
  <link rel="stylesheet" href="https://unpkg.com/prismjs/themes/prism.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/prismjs/plugins/line-numbers/prism-line-numbers.css" />
  <link rel="stylesheet" href="styles.css" />
  <!-- Marked para convertir markdown (si luego quieres mostrar también texto de las celdas): -->
  <script defer src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

  <style>
    .wrap { max-width: 1100px; margin: 0 auto; padding: 2rem 1.25rem }
    header { display:flex; align-items:center; justify-content:space-between; gap:1rem; padding:.5rem 0 1rem; border-bottom:1px solid var(--ring) }
    .crumbs a { opacity:.85 }
    h1 { margin: 1rem 0 .5rem; font-size: clamp(1.8rem, 3.5vw, 2.4rem) }
    .muted { color: var(--muted) }
    .toc { margin: 1rem 0 1.5rem; padding: 1rem; border:1px dashed var(--ring); border-radius: 1rem; background:#fff; box-shadow: var(--shadow) }
    .toc a { display:inline-block; margin:.25rem .6rem .25rem 0; padding:.35rem .7rem; border:1px solid var(--ring); border-radius:.8rem; }
    section.example { margin: 2rem 0; }
    .title { margin:.2rem 0; font-size: 1.3rem }
    .toolbar { display:flex; gap:.5rem; justify-content:flex-end; margin:.4rem 0 .6rem }
    .btn { padding:.45rem .75rem; border:1px solid var(--ring); border-radius:.6rem; background:#fff; cursor:pointer }
    pre { border-radius: 1rem; border:1px solid var(--ring); background:#fff; box-shadow: var(--shadow) }
    pre[class*="language-"] { margin:0 }
    .loading { font-size:.95rem; color: var(--muted); }
    .top { text-align:right; margin-top:.5rem }
    .top a { font-size:.9rem; opacity:.8 }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="crumbs"><a href="../index.html">← Portafolio</a></div>
      <nav><a href="https://github.com/" target="_blank" rel="noopener">GitHub</a></nav>
    </header>

    <main>
      <h1>Fundamentos de Python</h1>
      <p class="muted">Esta página carga automáticamente el <strong>código</strong> desde tus notebooks <code>.ipynb</code> y lo muestra con resaltado y números de línea.</p>

      <!-- ÍNDICE (se completa con JS) -->
      <nav class="toc" id="toc" aria-label="Índice del módulo"><strong>Índice:</strong></nav>

      <!-- Aquí se insertarán las secciones de cada notebook -->
      <div id="content"></div>
    </main>

    <footer style="margin-top:2rem; color:var(--muted)">© <span id="y"></span> Tu Nombre</footer>
  </div>

  <!-- Prism core + autoloader + líneas -->
  <script src="https://unpkg.com/prismjs/components/prism-core.min.js"></script>
  <script src="https://unpkg.com/prismjs/plugins/autoloader/prism-autoloader.min.js" data-autoloader-path="https://unpkg.com/prismjs/components/"></script>
  <script src="https://unpkg.com/prismjs/plugins/line-numbers/prism-line-numbers.min.js"></script>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // 1) Define aquí tus notebooks (título + ruta al .ipynb dentro del sitio)
    const NOTEBOOKS = [
      { id: 'clases',     titulo: 'Clases (OOP)',                   src: '../notebooks/Python-Clases.ipynb' },
      { id: 'geometria',  titulo: 'Geometría',                      src: '../notebooks/Python-Geometria.ipynb' },
      { id: 'productos',  titulo: 'Productos',                      src: '../notebooks/Python-Productos.ipynb' },
      { id: 'eda',        titulo: 'Exploratory Data Analysis (EDA)',src: '../notebooks/Pyhton-EDA.ipynb' }, // ojo al nombre
      { id: 'finbib',     titulo: 'Fin M2 · Biblioteca',            src: '../notebooks/Python-FinM2Biblioteca.ipynb' },
      { id: 'iteracion',  titulo: 'Iteración',                      src: '../notebooks/Python-Iteracion.ipynb' },
      // añade más si quieres
    ];

    // 2) Construir índice
    const toc = document.getElementById('toc');
    NOTEBOOKS.forEach(nb => {
      const a = document.createElement('a');
      a.href = `#${nb.id}`;
      a.textContent = nb.titulo;
      toc.appendChild(a);
    });

    // 3) Renderizar cada notebook: extrae SOLO celdas de código
    const content = document.getElementById('content');

    NOTEBOOKS.forEach(async ({id, titulo, src}) => {
      const section = document.createElement('section');
      section.className = 'example';
      section.id = id;

      section.innerHTML = `
        <h2 class="title">${titulo}</h2>
        <div class="toolbar">
          <button class="btn" data-copy-all>Copiar TODO el código</button>
        </div>
        <div class="loading">Cargando código desde <code>${src}</code>…</div>
        <div class="blocks"></div>
        <div class="top"><a href="#toc">↑ volver al índice</a></div>
      `;
      content.appendChild(section);

      try {
        const res = await fetch(src);
        if (!res.ok) throw new Error('No se pudo descargar el notebook');
        const nb = await res.json();

        const blocks = section.querySelector('.blocks');
        const loading = section.querySelector('.loading');
        loading.remove();

        const codes = [];
        (nb.cells || []).forEach((cell, idx) => {
          if (cell.cell_type === 'code') {
            const code = (cell.source || []).join('');
            codes.push(code);

            const pre = document.createElement('pre');
            pre.className = 'line-numbers';
            const codeEl = document.createElement('code');
            codeEl.className = 'language-python';
            codeEl.textContent = code;
            pre.appendChild(codeEl);

            // botón de copiar por bloque
            const tools = document.createElement('div');
            tools.className = 'toolbar';
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.textContent = `Copiar bloque #${idx+1}`;
            btn.addEventListener('click', async () => {
              try {
                await navigator.clipboard.writeText(code);
                const old = btn.textContent; btn.textContent = '¡Copiado!'; setTimeout(()=>btn.textContent=old, 1400);
              } catch { /* ignore */ }
            });
            tools.appendChild(btn);

            blocks.appendChild(tools);
            blocks.appendChild(pre);
          }
          // Si quieres mostrar markdown también:
          // if (cell.cell_type === 'markdown') {
          //   const md = document.createElement('div');
          //   md.innerHTML = marked.parse((cell.source || []).join(''));
          //   blocks.appendChild(md);
          // }
        });

        // Copiar TODO el código de la sección
        section.querySelector('[data-copy-all]').addEventListener('click', async (e) => {
          const all = codes.join('\n\n');
          try {
            await navigator.clipboard.writeText(all);
            const old = e.target.textContent; e.target.textContent = '¡Copiado!'; setTimeout(()=>e.target.textContent=old, 1400);
          } catch { /* ignore */ }
        });

        // Resalta todo lo que se acaba de inyectar
        Prism.highlightAllUnder(blocks);

      } catch (err) {
        const loading = section.querySelector('.loading');
        loading.textContent = 'Error cargando el notebook. ¿Está el archivo dentro del sitio y con el nombre correcto?';
      }
    });
  </script>
</body>
</html>
